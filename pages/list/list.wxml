<view class="container">
  <!-- 顶部导航栏，切换“找乘客 / 找司机” -->
  <view class="tab-bar">
    <button
      class="tab-button {{currentView === 'passenger' ? 'active' : ''}}"
      bindtap="gotoFindPassenger"
    >找乘客</button>
    <button
      class="tab-button {{currentView === 'driver' ? 'active' : ''}}"
      bindtap="gotoFindDriver"
    >找司机</button>
  </view>

  <!-- ==================== 找乘客 (passenger) ==================== -->
  <view wx:if="{{currentView === 'passenger'}}">
    <!-- 如果 showPassengerSearchPrompt 为 true，则显示提示 -->
    <view wx:if="{{showPassengerSearchPrompt}}" class="search-prompt">
      <text>请在首页搜索人找车或车找人</text>
    </view>

    <!-- 否则，展示排序 + 数据列表 -->
    <view wx:if="{{!showPassengerSearchPrompt}}">
      <!-- 排序字段 -->
      <picker
        mode="selector"
        range="{{passengerSortFields}}"
        rangeKey="label"
        value="{{passengerSortFieldIndex}}"
        bindchange="onPassengerSortFieldChange"
      >
        <view class="picker-view">
          排序字段：{{passengerSortFields[passengerSortFieldIndex].label}}
        </view>
      </picker>

      <!-- 排序升序 / 降序 -->
      <picker
        mode="selector"
        range="{{passengerSortOrderOptions}}"
        rangeKey="label"
        value="{{passengerSortOrderIndex}}"
        bindchange="onPassengerSortOrderChange"
      >
        <view class="picker-view">
          排序方式：{{passengerSortOrderOptions[passengerSortOrderIndex].label}}
        </view>
      </picker>

      <!-- 清除搜索按钮 -->
      <button class="clear-btn" bindtap="clearPassengerSearch">清除搜索</button>

      <!-- 数据列表 -->
      <view wx:if="{{passengerData.length === 0}}" class="no-data">
        <text>未找到符合条件的乘客</text>
      </view>
      <block wx:for="{{passengerData}}" wx:key="{{item._id}}">
        <view class="ride-item">
          <view><text class="label">出发地：</text>{{item.departure_place}}</view>
          <view><text class="label">目的地：</text>{{item.arrival_place}}</view>
          <view><text class="label">出发时间：</text>{{item.departure_date}} {{item.departure_time || '未知'}}</view>
          <view><text class="label">空余座位：</text>{{item.empty_seats}}</view>
          <view><text class="label">价格：</text>¥{{item.price}}</view>
          <view><text class="label">车型：</text>{{item.car_model || '未知'}}</view>
        </view>
      </block>
    </view>
  </view>

  <!-- ==================== 找司机 (driver) ==================== -->
  <view wx:if="{{currentView === 'driver'}}">
    <!-- 如果 showDriverSearchPrompt 为 true，则显示提示 -->
    <view wx:if="{{showDriverSearchPrompt}}" class="search-prompt">
      <text>请在首页搜索人找车或车找人</text>
    </view>

    <!-- 否则，展示排序 + 数据列表 -->
    <view wx:if="{{!showDriverSearchPrompt}}">
      <!-- 排序字段 -->
      <picker
        mode="selector"
        range="{{driverSortFields}}"
        rangeKey="label"
        value="{{driverSortFieldIndex}}"
        bindchange="onDriverSortFieldChange"
      >
        <view class="picker-view">
          排序字段：{{driverSortFields[driverSortFieldIndex].label}}
        </view>
      </picker>

      <!-- 升序/降序 -->
      <picker
        mode="selector"
        range="{{driverSortOrderOptions}}"
        rangeKey="label"
        value="{{driverSortOrderIndex}}"
        bindchange="onDriverSortOrderChange"
      >
        <view class="picker-view">
          排序方式：{{driverSortOrderOptions[driverSortOrderIndex].label}}
        </view>
      </picker>

      <!-- 清除搜索按钮 -->
      <button class="clear-btn" bindtap="clearDriverSearch">清除搜索</button>

      <!-- 数据列表 -->
      <view wx:if="{{driverData.length === 0}}" class="no-data">
        <text>未找到符合条件的司机</text>
      </view>
      <block wx:for="{{driverData}}" wx:key="{{item._id}}">
        <view class="request-item">
          <view><text class="label">出发地：</text>{{item.departure_place}}</view>
          <view><text class="label">目的地：</text>{{item.arrival_place}}</view>
          <view><text class="label">出发时间：</text>{{item.departure_date}} {{item.departure_time || '未知'}}</view>
          <view><text class="label">期望价格：</text>¥{{item.price}}</view>
          <view><text class="label">出发人数：</text>{{item.passenger_number}}</view>
        </view>
      </block>
    </view>
  </view>
</view>
