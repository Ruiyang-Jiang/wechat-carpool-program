<!-- é¡µé¢éª¨æ¶ï¼šç®€è¦ loading -->
<view wx:if="{{isLoading}}" class="page-loading">åŠ è½½ä¸­...</view>

<block wx:else>
  <!-- ======= è¡Œç¨‹ä¿¡æ¯å¡ ======= -->
  <view class="ride-card {{detail.isPast?'past':''}}">
    <!-- header -->
    <view class="ride-header">
      <text class="badge {{detail.type==='ride'?'badge-driver':'badge-passenger'}}">
        {{detail.type==='ride'?'æ‰¾ä¹˜å®¢':'æ‰¾å¸æœº'}}
      </text>
      <text class="ride-date {{detail.isPast?'date-past':''}}">
        {{detail.departure_date}} {{detail.departure_time||'00:00'}}
      </text>
      <text wx:if="{{detail.isPast}}" class="expired-badge">å·²è¿‡æœŸ</text>
    </view>

    <!-- body -->
    <view class="ride-body">
      <view class="row">
        <text>å‡ºå‘åœ°ï¼š</text>
        <text class="bold">{{detail.departure_place.city}}, {{detail.departure_place.state}}</text>
      </view>
      <view class="row">
        <text>ç›®çš„åœ°ï¼š</text>
        <text class="bold">{{detail.arrival_place.city}}, {{detail.arrival_place.state}}</text>
      </view>

      <!-- ============ æ‰¾ä¹˜å®¢ï¼ˆrideï¼‰ä¸“å±å­—æ®µ ============ -->
      <block wx:if="{{detail.type==='ride'}}">
        <view class="row">
          <text>ç©ºä½™åº§ä½ï¼š</text><text class="bold">{{detail.empty_seats}}</text>
        </view>

        <!-- ğŸ‘‰ è½¦å‹ï¼šä»…å½“æœ‰å¡«å†™æ—¶æ˜¾ç¤º ğŸ‘ˆ -->
        <view class="row" wx:if="{{detail.car_model}}">
          <text>è½¦å‹ï¼š</text><text class="bold">{{detail.car_model}}</text>
        </view>
      </block>

      <!-- ============ æ‰¾å¸æœºï¼ˆrequestï¼‰ä¸“å±å­—æ®µ ============ -->
      <block wx:elif="{{detail.type==='request'}}">
        <view class="row">
          <text>ä¹˜åäººæ•°ï¼š</text><text class="bold">{{detail.passenger_number}}</text>
        </view>
      </block>

      <!-- å…±ç”¨å­—æ®µï¼šä»·æ ¼ -->
      <view class="row">
        <text>ä»·æ ¼ï¼š</text><text class="bold">{{detail.price}}</text>
      </view>
    </view>
  </view>

  <!-- ======= å‘å¸ƒè€…ä¿¡æ¯ ======= -->
  <view class="publisher-card">
    <view class="publisher-row">
      <text>å‘å¸ƒè€…ï¼š</text>
      <text class="bold">{{publisherInfo.nickName || 'ç”¨æˆ·'}}</text>
    </view>
    <view class="publisher-row">
      <text>è”ç³»å¾®ä¿¡ï¼š</text>
      <text class="bold">{{publisherInfo.wechat || 'æœªæä¾›'}}</text>
      <button type="primary" size="mini" bindtap="handleCopyWeChat" wx:if="{{publisherInfo.wechat}}">å¤åˆ¶</button>
    </view>
  </view>

  <!-- ======= æ“ä½œæŒ‰é’® ======= -->
  <button class="action-btn" type="primary" bindtap="takeOrder"
          wx:if="{{userOpenid && userOpenid !== detail.publisher_id}}">
    {{detail.type==='ride' ? 'æˆ‘è¦ä¹˜å' : 'æˆ‘è¦æ¥å•'}}
  </button>
</block>
