<!-- 引入卡片模板 -->
<import src="ride-card.wxml"/>

<!-- ======= 顶部三大 Tab ======= -->
<view class="tabs">
  <view class="tab {{currentTab==='passenger'?'active':''}}" bindtap="switchToPassenger">乘坐记录</view>
  <view class="tab {{currentTab==='driver'?'active':''}}"    bindtap="switchToDriver">接单记录</view>
  <view class="tab {{currentTab==='mine'?'active':''}}"      bindtap="switchToMine">我发布</view>
</view>

<!-- ======= 页脚登录按钮 ======= -->
<view wx:if="{{!loggedIn}}" class="login-footer">
  <button class="login-btn" type="primary" bindtap="loginViaCloudFunction">登录</button>
  <text class="login-hint">登录后可查看和管理您的顺风车记录</text>
</view>

<!-- ================= 乘坐记录 ================= -->
<block wx:if="{{currentTab==='passenger'}}">
  <view wx:if="{{ridesAsPassenger.length === 0}}" class="empty-tip">
    暂无乘坐记录
  </view>
  <block wx:for="{{ridesAsPassenger}}" wx:key="_id">
    <template is="rideCard" data="{{ item: item, currentTab: currentTab }}"/>
  </block>
</block>

<!-- ================= 接单记录 ================= -->
<block wx:elif="{{currentTab==='driver'}}">
  <view wx:if="{{ridesAsDriver.length === 0}}" class="empty-tip">
    暂无接单记录
  </view>
  <block wx:for="{{ridesAsDriver}}" wx:key="_id">
    <template is="rideCard" data="{{ item: item, currentTab: currentTab }}"/>
  </block>
</block>

<!-- ================= 我发布 ================= -->
<block wx:elif="{{currentTab==='mine'}}">
  <view wx:if="{{myPublished.length === 0}}" class="empty-tip">
    暂无发布记录
  </view>
  <block wx:for="{{myPublished}}" wx:key="_id">
    <template is="rideCard" data="{{ item: item, currentTab: currentTab }}"/>
  </block>
</block>
